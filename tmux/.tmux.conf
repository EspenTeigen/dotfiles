set -g prefix C-b
bind C-b send-prefix
unbind r
bind -N "Reload tmux config" r source-file ~/.tmux.conf

set -g mouse on
set-window-option -g mode-keys vi

# Vi-mode copy bindings
bind-key -T copy-mode-vi -N "Begin selection" v send-keys -X begin-selection
bind-key -T copy-mode-vi -N "Copy selection to clipboard" y send-keys -X copy-pipe-and-cancel "wl-copy"
bind-key -T copy-mode-vi -N "Toggle rectangle selection" C-v send-keys -X rectangle-toggle

unbind '"'
unbind %
bind -N "Split window horizontally" - split-window -v
bind -N "Split window vertically" | split-window -h
bind -N "Kill pane with confirmation" q confirm-before -p "kill-pane #P? (y/n)" kill-pane
bind -N "Display pane numbers" p display-panes
bind -N "Session picker" s choose-tree -sZ
bind -r -N "Resize pane left" h resize-pane -L 5
bind -r -N "Resize pane down" j resize-pane -D 5
bind -r -N "Resize pane up" k resize-pane -U 5
bind -r -N "Resize pane right" l resize-pane -R 5

# Modern color scheme
set -g default-terminal "tmux-256color"
set -ag terminal-overrides ",xterm-256color:RGB"

# Status bar colors and styling - Tokyo Night Dark
set -g status-bg '#1a1b26'
set -g status-fg '#c0caf5'
set -g status-left-length 40
set -g status-right-length 80

# Window status styling
set -g window-status-current-style 'fg=#1a1b26,bg=#7aa2f7,bold'
set -g window-status-style 'fg=#9aa5ce,bg=#414868'
set -g window-status-separator ' '

# Pane border colors (local vs SSH)
set -g pane-border-style 'fg=#414868'
set -g pane-active-border-style '#{?#{m:*ssh*,#{pane_current_command}},fg=#ff9e64,fg=#7aa2f7}'

# Message styling
set -g message-style 'fg=#1a1b26,bg=#9ece6a'
set -g message-command-style 'fg=#1a1b26,bg=#e0af68'

# Status bar content
set -g status-left '#[fg=#1a1b26,bg=#7aa2f7,bold] #{session_name} #[fg=#7aa2f7,bg=#1a1b26]'
set -g status-right '#[fg=#9aa5ce]#{continuum_status} #[fg=#414868]‚îÇ #[fg=#c0caf5]%H:%M #[fg=#414868]‚îÇ #[fg=#9ece6a]%d %b'

# Window status format
set -g window-status-current-format '#[fg=#1a1b26,bg=#7aa2f7]#[fg=#1a1b26,bg=#7aa2f7,bold] #I:#W#{?window_zoomed_flag, üîç,} #[fg=#7aa2f7,bg=#1a1b26]'
set -g window-status-format '#[fg=#9aa5ce,bg=#414868] #I:#W '

# Plugins
set -g @plugin 'christoomey/vim-tmux-navigator'
set -g @plugin 'tmux-plugins/tpm'
set -g @plugin 'tmux-plugins/tmux-resurrect'
set -g @plugin 'tmux-plugins/tmux-continuum'

# Session persistence configuration
set -g @continuum-restore 'off'
set -g @continuum-save-interval '15'
set -g @resurrect-capture-pane-contents 'on'

# Easy pane renaming
bind-key -N "Rename current pane" , command-prompt -p "rename pane:" "select-pane -T '%%'"

# Mark pane and swap with marked pane
bind-key -N "Mark pane" m select-pane -m
bind-key -N "Swap with marked pane" M swap-pane \; select-pane -M

# Move panes with Shift+hjkl (like sway window movement)
bind-key -N "Swap pane up" H swap-pane -U
bind-key -N "Swap pane down" J swap-pane -D
bind-key -N "Swap pane up" K swap-pane -U
bind-key -N "Swap pane down" L swap-pane -D

# Enhanced pane titles and borders with SSH indicator
set -g pane-border-status top
set -g pane-border-format "#[fg=#{?#{m:*ssh*,#{pane_current_command}},#ff9e64,#7aa2f7},bg=#1a1b26] #{?pane_active,#[bold],}#{?#{m:*ssh*,#{pane_current_command}}, üåê , üè† }#P: #{pane_title} #{?pane_active,#[nobold],} "

# TPM init at bottom
run '~/.tmux/plugins/tpm/tpm'

